{{ if eq .osid "linux-fedora" -}}
#!/bin/bash

# 设置zsh为默认shell
chsh -s $(which zsh)

# kanata系统服务
sudo cp {{ .chezmoi.config.sourceDir -}}/system/services/kanata.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable kanata.service
sudo systemctl start kanata.service

# 服务管理
systemctl --user add-wants niri.service dms

# 设置fcitx5为默认输入法
imsettings-switch fcitx5

# 单独为微信设置环境变量
sed -i 's|^Exec=.*|Exec=env GTK_IM_MODULE=fcitx QT_IM_MODULE=fcitx /usr/bin/wechat %U|' {{ .chezmoi.homeDir -}}/.local/share/applications/wechat.desktop

# 单独安装verysync
if [ ! -d "/usr/bin/verysync" ]; then
    curl -k https://www.verysync.com/shell/verysync-linux-installer/go-installer.sh > {{ .chezmoi.homeDir -}}/tmp/go-installer.sh
    chmod +x {{ .chezmoi.homeDir -}}/tmp/go-installer.sh
    sudo {{ .chezmoi.homeDir -}}/tmp/go-installer.sh
fi

{{ end -}}
