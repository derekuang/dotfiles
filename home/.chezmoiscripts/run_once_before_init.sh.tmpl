{{ if eq .osid "linux-fedora" -}}
#!/usr/bin/env bash

# 代理
# 换源
#sudo sed -e 's|^metalink=|#metalink=|g' \
#    -e 's|^#baseurl=http://download.example/pub/fedora/linux|baseurl=https://mirrors.tuna.tsinghua.edu.cn/fedora|g' \
#    -i.bak \
#    /etc/yum.repos.d/fedora.repo \
#    /etc/yum.repos.d/fedora-updates.repo
#sudo dnf makecache

# Terra软件源
if ! dnf repo list | grep terra -q; then
    sudo dnf install --nogpgcheck --repofrompath 'terra,https://repos.fyralabs.com/terra$releasever' terra-release
fi

# copr第三方源
{{ range .packages.fedora.copr -}}
    if ! dnf copr list | grep {{ . }} -q; then
        sudo dnf copr enable {{ . }}
    fi
{{ end -}}

# flathub仓库
sudo flatpak remote-add --if-not-exists flathub https://flathub.org/repo/flathub.flatpakrepo
flatpak update --appstream

{{ end -}}
